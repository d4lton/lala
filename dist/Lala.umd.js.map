{"version":3,"file":null,"sources":["../src/ParseError.js","../src/Parser.js","../src/Lexer.js","../src/InterpretError.js","../src/Interpreter.js","../src/Lala.js"],"sourcesContent":["/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nfunction ParseError(message, token, expected) {\n  this.message = message;\n  this.token = token;\n  this.expected = expected;\n};\nParseError.prototype = new Error;\n\nexport default ParseError;\n","/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nimport ParseError from './ParseError.js';\n\nclass Parser {\n\n  constructor(grammar, lexer) {\n    this.grammar = grammar;\n    this.lexer = lexer;\n    this.token = this.lexer.nextToken();\n  };\n\n  reset() {\n    this.lexer.reset();\n    this.token = this.lexer.nextToken();\n  };\n\n  cloneCurrentToken() {\n    return JSON.parse(JSON.stringify(this.token));\n  };\n\n  eat(type, value) {\n    if (this.token.type == type && ((typeof value !== 'undefined') ? (this.token.value == value) : true)) {\n      this.token = this.lexer.nextToken();\n    } else {\n      if (typeof value !== 'undefined') {\n        throw new ParseError('Expected ' + type + ': \"' + value + '\"', this.cloneCurrentToken(), {type: type, value: value});\n      } else {\n        throw new ParseError('Expected ' + type, this.cloneCurrentToken(), {type: type});\n      }\n    }\n  };\n\n  factor() {\n    var token = this.cloneCurrentToken();\n    if (token.type == 'number') {\n      this.eat(token.type);\n      return {\n        type: 'NumericConstant',\n        value: token.value,\n        start: token.start,\n        end: token.end\n      };\n    } else if (token.type == \"string\") {\n      this.eat(token.type);\n      return {\n        type: 'StringConstant',\n        value: token.value,\n        start: token.start,\n        end: token.end\n      };\n    } else if (token.type == 'identifier') {\n      this.eat(token.type);\n      return {\n        type: 'Variable',\n        value: token.value,\n        start: token.start,\n        end: token.end\n      }\n    } else if (token.type == 'parenthesis') {\n      this.eat(token.type, '(');\n      var result = this.expression();\n      this.eat('parenthesis', ')');\n      return result;\n    } else if (token.type == 'braces') {\n      this.eat(token.type, '{');\n      var result = this.block();\n      this.eat('braces', '}');\n      return result;\n    } else {\n      throw new ParseError('Expected an expression', token);\n    }\n  };\n\n  makeTermNode(type, node) {\n    var token = this.cloneCurrentToken();\n    this.eat(this.token.type);\n    return {\n      type: type,\n      left: node,\n      operator: token.value,\n      right: this.factor(),\n      start: token.start,\n      end: token.end\n    };\n  };\n\n  term() {\n\n    var node = this.factor();\n\n    var foundOperator = false;\n    do {\n      foundOperator = false;\n      for (var i = 0; i < this.grammar.operators.length; i++) {\n        while (this.token && this.token.type === 'operator' && this.token.value === this.grammar.operators[i].value) {\n          node = this.makeTermNode(this.grammar.operators[i].result, node);\n          foundOperator = true;\n        }\n      }\n    } while (foundOperator);\n\n    return node;\n\n  };\n\n  expression() {\n\n    for (var i = 0; i < this.grammar.expressions.length; i++) {\n      var rules = this.grammar.expressions[i].rules;\n      if (rules && rules.length > 0) {\n        var valueMatch = false;\n        if (rules[0].value) {\n          valueMatch = (rules[0].value === this.token.value);\n        }\n        if (rules[0].values) {\n          valueMatch = (rules[0].values.indexOf(this.token.value) !== -1);\n        }\n        if (rules[0].type === this.token.type && valueMatch) {\n          var node = {\n            type: this.grammar.expressions[i].result,\n            value: this.token.value,\n            start: this.token.start,\n            end: this.token.end\n          };\n          for (var j = 0; j < rules.length; j++) {\n            var rule = rules[j];\n            if (rule.optional === true && (!this.token || this.token.type != rule.type)) {\n              break;\n            }\n            if (rule.parse) {\n              node[rule.result] = this[rule.parse]();\n            } else {\n              this.eat(rule.type, rule.value);\n            }\n          }\n          return node;\n        }\n      }\n    }\n\n    return this.term();\n\n  };\n\n  block() {\n\n    var node = {\n      type: 'Block',\n      nodes: []\n    };\n\n    while (this.token && this.token.type !== 'braces' && this.token.value !== '}') {\n      node.nodes.push(this.expression());\n    }\n\n    return node;\n  };\n\n  program() {\n    var nodes = [];\n    while (this.token) {\n      nodes.push(this.expression());\n    };\n    return nodes;\n  };\n\n  parse() {\n    this.reset();\n    return this.program();\n  };\n\n};\n\nexport default Parser;\n","/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nclass Lexer {\n\n  constructor(lexicon, text) {\n    this.lexicon = lexicon;\n    this.text = text;\n    this.pos = -1;\n  }\n\n  reset() {\n    this.pos = -1;\n  };\n\n  next() {\n    if (!this.end()) {\n      this.pos++;\n      this.current = this.text[this.pos];\n      return this.current;\n    }\n  };\n\n  peek() {\n    return this.text[this.pos + 1];\n  };\n\n  end() {\n    return (this.pos >= (this.text.length - 1));\n  };\n\n  scanstring(lex) {\n    var result = ''; // ignore the initial quotation mark\n    // TODO: should check for escaped quotation marks\n    while ((typeof this.peek() !== 'undefined') && this.peek() !== '\"') {\n      result += this.next();\n    }\n    this.next(); // eat the final quotation mark\n    return result;\n  };\n\n  scan(lex) {\n    var result = this.current;\n    if (lex.scanner) {\n      return this['scan' + lex.scanner](lex);\n    }\n    if (lex.test) {\n      while ((typeof this.peek() !== 'undefined') && lex.test.test(this.peek())) {\n        result += this.next();\n      };\n      if (lex.keepLast === true) {\n        result += this.next();\n      }\n    }\n    return result;\n  };\n\n  getToken() {\n    if (!this.end()) {\n      var c = this.next();\n      var types = Object.keys(this.lexicon);\n      for (var i = 0; i < types.length; i++) {\n        var type = types[i];\n        if (this.lexicon[type].startTest.test(c)) {\n          var start = this.pos;\n          var value = this.scan(this.lexicon[type]);\n          if (this.lexicon[type].values && this.lexicon[type].values.indexOf(value) === -1) {\n            throw new Error(value + ' token matches ' + type + ' regex, but not one of ' + this.lexicon[type].values.join(','));\n          }\n          return {\n            start: start,\n            end: this.pos,\n            type: type,\n            value: value\n          }\n        }\n      }\n      throw new Error('could not match: ' + c);\n    }\n  };\n\n  nextToken() {\n    var token = this.getToken();\n    while (token && token.type == 'ignore') {\n      token = this.getToken();\n    }\n    return token;\n  };\n\n  allTokens() {\n    var results = [];\n    var token = this.nextToken();\n    while (token) {\n      results.push(token);\n      token = this.nextToken();\n    }\n    return results;\n  };\n\n};\n\nexport default Lexer;\n","/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nfunction InterpretError(message, node) {\n  this.message = message;\n  this.node = node;\n};\nInterpretError.prototype = new Error;\n\nexport default InterpretError;\n","/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nimport Parser from './Parser.js';\nimport InterpretError from './InterpretError.js';\n\nclass Interpreter {\n\n  constructor(parser) {\n    this.parser = parser;\n  };\n\n  visitCallStatement(node) {\n    if (typeof this.callback === 'function') {\n      this.callback(node.value);\n    }\n  };\n\n  visitBlock(node) {\n    var result;\n    node.nodes.forEach(function(root) {\n      result = this.visit(root);\n    }.bind(this));\n    return result;\n  };\n\n  visitNumericConstant(node) {\n    return parseFloat(node.value);\n  };\n\n  visitStringConstant(node) {\n    return node.value;\n  };\n\n  visitVariable(node) {\n    if (typeof this.variables[node.value] !== 'undefined') {\n      return this.variables[node.value];\n    } else {\n      throw new InterpretError('Unknown identifier: ' + node.value, node);\n    }\n  };\n\n  visitMathExpression(node) {\n    if (node.operator === '+') {\n      return this.visit(node.left) + this.visit(node.right);\n    }\n    if (node.operator === '-') {\n      return this.visit(node.left) - this.visit(node.right);\n    }\n    if (node.operator === '*') {\n      return this.visit(node.left) * this.visit(node.right);\n    }\n    if (node.operator === '-') {\n      return this.visit(node.left) - this.visit(node.right);\n    }\n    throw new InterpretError('Uknown operator: ' + node.operator, node);\n  };\n\n  visitAssignmentExpression(node) {\n    var value = this.visit(node.right);\n    if (isNaN(value)) {\n      return this.variables[node.left.value] = value;\n    } else {\n      return this.variables[node.left.value] = parseFloat(value);\n    }\n  };\n\n  visitComparisonExpression(node) {\n    if (node.operator === '==') {\n      return this.visit(node.left) == this.visit(node.right);\n    }\n    if (node.operator === '!=') {\n      return this.visit(node.left) != this.visit(node.right);\n    }\n    if (node.operator === '<=') {\n      return this.visit(node.left) <= this.visit(node.right);\n    }\n    if (node.operator === '>=') {\n      return this.visit(node.left) >= this.visit(node.right);\n    }\n    if (node.operator === '<') {\n      return this.visit(node.left) < this.visit(node.right);\n    }\n    if (node.operator === '>') {\n      return this.visit(node.left) > this.visit(node.right);\n    }\n    throw new InterpretError('Uknown operator: ' + node.operator, node);\n  }\n\n  visitLogicalExpression(node) {\n    if (node.operator === '||') {\n      return this.visit(node.left) || this.visit(node.right);\n    }\n    if (node.operator === '&&') {\n      return this.visit(node.left) && this.visit(node.right);\n    }\n    throw new InterpretError('Uknown operator: ' + node.operator, node);\n  };\n\n  visitIfStatement(node) {\n    if (this.visit(node.test)) {\n      return this.visit(node.consequence);\n    } else {\n      if (node.alternate) {\n        return this.visit(node.alternate);\n      }\n    }\n  };\n\n  visit(node) {\n    var method = 'visit' + node.type;\n    if (typeof this[method] === 'function') {\n      return this[method](node);\n    } else {\n      throw new Error('visit method \"' + method + '\" not found');\n    }\n  };\n\n  run(variables, callback) {\n\n    this.variables = {};\n    if (typeof variables == 'object') {\n      this.variables = variables;\n    }\n\n    this.callback = callback;\n\n    var nodes = this.parser.parse();\n    var result;\n    nodes.forEach(function(node) {\n      result = this.visit(node);\n    }.bind(this));\n    return result;\n\n  };\n\n};\n\nexport default Interpreter;\n","/**\n * Hemp\n *\n * Copyright ©2017 Dana Basken <dbasken@gmail.com>\n *\n */\nimport Parser from './Parser.js';\nimport Lexer from './Lexer.js';\nimport Interpreter from './Interpreter.js';\nimport ParseError from './ParseError.js';\nimport InterpretError from './InterpretError.js';\n\nclass Lala {\n\n  constructor() {\n\n    this.lexicon = {\n      ignore: {\n        startTest: /[ \\t\\n;]/,\n        test: /[ \\t\\n;]/\n      },\n      identifier: {\n        startTest: /[a-zA-Z]/,\n        test: /[a-zA-Z_\\.]/\n      },\n      number: {\n        startTest: /[0-9\\-]/,\n        test: /[0-9\\.]/\n      },\n      string : {\n        startTest: /[\"]/,\n        scanner: 'string'\n      },\n      operator: {\n        startTest: /[\\+\\-\\*\\/><=|&!]/,\n        test: /[\\+\\-\\*\\/><=|&!]/,\n        values: ['=', '+', '-', '*', '/', '==', '!=', '>=', '<=', '<', '>', '||', '&&']\n      },\n      parenthesis: {\n        startTest: /[\\(\\)]/\n      },\n      braces: {\n        startTest: /[{}]/\n      }\n    };\n\n    this.grammar = {\n      operators: [\n        {value: '+', result: 'MathExpression'},\n        {value: '-', result: 'MathExpression'},\n        {value: '*', result: 'MathExpression'},\n        {value: '/', result: 'MathExpression'},\n        {value: '==', result: 'ComparisonExpression'},\n        {value: '!=', result: 'ComparisonExpression'},\n        {value: '<=', result: 'ComparisonExpression'},\n        {value: '>=', result: 'ComparisonExpression'},\n        {value: '>', result: 'ComparisonExpression'},\n        {value: '<', result: 'ComparisonExpression'},\n        {value: '||', result: 'LogicalExpression'},\n        {value: '&&', result: 'LogicalExpression'},\n        {value: '=', result: 'AssignmentExpression'}\n      ],\n      expressions: [\n        {\n          result: 'IfStatement',\n          rules: [\n            {type: 'identifier', value: 'if'},\n            {type: 'parenthesis', value: '('},\n            {parse: 'term', result: 'test'},\n            {type: 'parenthesis', value: ')'},\n            {parse: 'expression', result: 'consequence'},\n            {type: 'identifier', value: 'else', optional: true},\n            {parse: 'expression', result: 'alternate'}\n          ]\n        },\n        {\n          result: 'CallStatement',\n          rules: [\n            {type: 'identifier', values: ['hide', 'show']},\n            {type: 'parenthesis', value: '('},\n            {type: 'parenthesis', value: ')'}\n          ]\n        },\n        {\n          result: 'BooleanConstant',\n          rules: [\n            {type: 'identifier', values: ['true', 'false']}\n          ]\n        }\n      ]\n    };\n\n  };\n\n  check(text, variables) {\n    var lexer = new Lexer(this.lexicon, text);\n    var parser = new Parser(this.grammar, lexer);\n    return parser.parse();\n  };\n  \n  run(text, variables, callback) {\n    var lexer = new Lexer(this.lexicon, text);\n    var parser = new Parser(this.grammar, lexer);\n    var interpreter = new Interpreter(parser);\n    return {\n      returnValue: interpreter.run(variables, callback),\n      variables: interpreter.variables\n    };\n  }\n\n};\n\nLala.Parser = Parser;\nLala.Lexer = Lexer;\nLala.ParseError = ParseError;\nLala.InterpretError = InterpretError;\n\nexport default Lala;\n"],"names":["ParseError","message","token","expected","prototype","Error","Parser","grammar","lexer","nextToken","reset","JSON","parse","stringify","type","value","cloneCurrentToken","eat","start","end","result","expression","block","node","factor","foundOperator","i","operators","length","makeTermNode","expressions","rules","valueMatch","values","indexOf","j","rule","optional","term","nodes","push","program","Lexer","lexicon","text","pos","current","lex","peek","next","scanner","test","keepLast","c","types","Object","keys","startTest","scan","join","getToken","results","InterpretError","Interpreter","parser","callback","forEach","root","visit","bind","parseFloat","variables","operator","left","right","isNaN","consequence","alternate","method","Lala","interpreter","run"],"mappings":"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"}